# see: https://www.appveyor.com/docs/appveyor-yml/

image: Visual Studio 2017

version: 1.0.{build}

#- call "c:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvarsall.bat" x64
#- cmake -G "Ninja" -DCMAKE_MAKE_PROGRAM="C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO\2017\COMMUNITY\COMMON7\IDE\COMMONEXTENSIONS\MICROSOFT\CMAKE\Ninja\ninja.exe" -DCMAKE_BUILD_TYPE="RelWithDebInfo" ..
#- cmake -–build . --config RelWithDebInfo

#- cmake -G "Visual Studio 15 2017 Win64" ..
#- cmake -–build . -–config Release

build_script:
- SET PATH="C:\Python36-x64";%path%
- python --version
- cmd: ren c:\python27 python27-hide
- md build
- cd build
- call "c:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvarsall.bat" x64
- cmake -G "Ninja" -DCMAKE_MAKE_PROGRAM="C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO\2017\COMMUNITY\COMMON7\IDE\COMMONEXTENSIONS\MICROSOFT\CMAKE\Ninja\ninja.exe" -DCMAKE_BUILD_TYPE="RelWithDebInfo" ..
- cmake -–build . --config RelWithDebInfo ..


artifacts:
- path: build\src\JSBSim.exe
  name: JSBSim_Release_x64_v2018a

# Do not build on tags (GitHub and BitBucket)
# to avoid infinite build loops
skip_tags: true

# Removed tag: JSBSim-win64-v$(appveyor_build_version)

deploy:
- provider: GitHub
  tag: JSBSim-win64-v2018a
  description: VS 2017 - Release - x64
  auth_token:
    secure: YWG8FRFWv/ylTuA1DIFNcN01uFGz7xKit8CayOMTE0orPKXhztwLmwm8MZ4IzFbr
  artifact: build\src\JSBSim.exe
  prerelease: true
  on:
    branch: master
